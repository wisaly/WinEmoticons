WinEmotions 使用手册
===================
简介
----
萌颜文字是一个Windows系统上的外挂式颜文字输入工具，设计的初衷是可以通过快捷键弹出的窗口中用鼠标点击来选择想要输入的颜文字。它相比使用输入法用户词库的方式的优势是，可以方便的使用分组管理，方便的输入选择的内容。

许可协议
-------
WinEmoticons是自由软件，使用GPL协议（GNU General Public License），开放源代码，可以自由分发。


使用简介
-------
没耐心的同学直接看常见问题的Q1。

运行主程序，第一次运行时会弹出配置对话框，可以执行以下操作：

1. 可以勾选“不在启动时弹框”，勾选之后下次启动时会默认隐藏主窗口。
2. 点击“编辑词库”按钮，配置所有的词库，编辑方法详见高级用法。
3. 点击“隐藏”按钮，会使程序最小化到系统托盘区。
4. 点击标题栏的叉号，将会退出程序。

在输入文字的过程中，按下快捷键会弹出颜文字选择窗口，默认的快捷键是“Ctrl+E”。
鼠标点击标签可以切换分组，点击颜文字输入内容。关闭选择窗口同样使用快捷键“Ctrl+E”。

颜文字选择窗口默认会在鼠标所在位置弹出，可以拖动标题栏来移动窗口，可以拖动边框来缩放窗口大小。当关闭选择窗口时，当前窗口大小将会保存到配置文件。

双击托盘区的图标，将会显示或隐藏配置对话框，右键点击托盘区图标可以选择退出程序。

高级用法
-------

### 编辑颜文字词库
在配置对话框点击“编辑词库”按钮，会弹出编辑词库的对话框。
注意，编辑词库时会自动隐藏颜文字选择对话框，并且在编辑词库的过程中不能用快捷键呼出。

萌颜文字的词库具有两层的分级：分组和词汇，简单来说就是词库中可能包含多个分组，每个分组里面包含很多颜文字。这样做的目的是方便在输入时快速根据分组定位到文字。

编辑词库对话框左右两个列表分别是分组和词汇的列表，点击左边的列表中的分组，右边的列表就会展示选中的分组中的词汇。
列表的左右两边各有5个按钮，它们的功能分别是添加（+）、删除（-）、编辑（=）、前移（<）、后移（>）。
其中点击添加按钮将弹出批量添加的输入对话框，每行一个，空行会被忽略。
为防止误删，删除分组时会有确认提示，而删除颜文字时没有确认提示。前移后移将会改变显示的顺序。

对话框下面的“行数”和“列数”指的是弹出的颜文字选择对话框中每页的行数和列数，超出部分不显示，也就是说，每个分组中的词汇数量不能超过“行数”乘以“列数”。

点击“清空”按钮会清空所有分组和词汇。

点击“导出”按钮将会弹出导出对话框，用于导出当前的词库。

点击“导入”按钮将会弹出导入对话框，用于导入别人导出的词库。注意，导入时会自动清空当前词库。

点击“确定”按钮将关闭对话框，并保存配置。

点击“取消”按钮将关闭对话框，不保存配置。

### 导出词库
点击“导出”按钮将弹出导出词库对话框，输入作者和标题（可以不填），然后点击“选择文件”按钮来选择导出的路径。默认会以时间生成一个默认文件名，可以直接保存。

### 编辑导出的词库文件
为了方便使用，导出的文件是文本文件。
如果需要手工编辑它，请仔细阅读本节内容。

它的前5行是导出的附加信息，第6行是作者，第7行是标题，第8行是分割线。注意，前8行不能有空行。
从第9行开始，使用50个“=”号作为一个分组结束的标记。每个分组的第1行是分组名（分组名是必须的），接下来N行是这个分组的词汇，直到结束标记。

### 导入词库
点击“导入”按钮将弹出导入词汇对话框，点击“选择文件”按钮选择要导入的文件。选择之后会展示这个文件的信息，包括作者、标题、分组及词汇数量统计。确认无误后点击“导入”按钮完成导入。

### 编辑配置文件
萌颜文字使用XML文件作为配置文件的格式，配置文件中的参数有的可以通过界面修改，但大部分参数没有提供修改界面，只能手工修改XML文件。修改在下次启动程序时生效。

WinEmoticons使用的XML文件是UTF-8编码的文本文件，使用记事本就可以编辑。

下面是所有参数的说明和示例值。

1. WEConfig/ConfigWindow 配置窗口
 * PopAtStart="true" 是否在启动是弹出配置窗口
2. WEConfig/AccerateKey 加速键
 * PopSelect="Ctrl+E" 弹出颜文字选择对话框的快捷键
3. WEConfig/PopWindow 弹出窗口
 * CtrlPadding="5" 内含控件距离窗口的距离
 * FontSize="100" 字体大小，是字号的10倍值
 * FontName="微软雅黑" 字体名
 * Width="300" 弹出窗口宽度
 * Height="400" 弹出窗口高度
4. WEConfig/PopWindow/PageHeader 标签页标题
 * HeaderHorzMargin="5" 标签页之间的横向间距
 * HeaderTopMargin="5" 标签页与顶部间距
 * HeaderActiveHorzMargin="5" 激活的标签页之间的横向间距
 * HeaderActiveTopMargin="0" 激活的标签页与顶部的间距
 * PagePadding="2" 标签页四周到父控件的距离
5. WEConfig/PopWindow/Pages 标签页
6. WEConfig/PopWindow/Pages/Colors 颜色列表，标签页依次使用列表中的值作为自己的颜色，如果标签页的数量大于列表中颜色的数量，则会循环使用颜色列表
 * Color rgb="44,143,197" 颜色的rgb值，红、绿、蓝，0~255，逗号分隔
7. WEConfig/PopWindow/PageItem 标签页单元
 * ItemPadding="5" 单元直接的间距
 * ColumnCount="3" 每页包含列数
 * RowCount="5" 每页包含行数
8. WEConfig/PopWindow/PageItem/Colors 单元颜色
 * Background="255,255,255" 背景色
 * Foreground="0,0,0" 前景色，即文字颜色
 * Hightlight="255,255,255" 高亮颜色（未使用）
 * Checked="255,255,255" 选中颜色（未使用）
 * Disabled="128,128,128" 禁用颜色（未使用）
9. WEConfig/Emoticons 词库
10. WEConfig/Emoticons/Pages 分组列表
11. WEConfig/Emoticons/Pages/Page 一个分组
 * Caption="Page1" 分组标题
12. WEConfig/Emoticons/Pages/Page/Item 一个词汇
 * Item Content="（｀・ω・´）" 内容

常见问题
-------

Q1:手册太长了懒得看，能先告诉我怎么用么？
> A:运行后点“隐藏”，按Ctrl+E弹出选择框，鼠标点击输入。

Q2:程序运行不了。
> A:据我分析，目前程序有两个依赖的库可能不存在，一个是VS2008运行时库：[下载](http://www.microsoft.com/zh-cn/download/details.aspx?id=29)。另一个是msxml库：[下载](http://www.microsoft.com/zh-cn/download/details.aspx?id=3988)。如果都装了还是不行，请参考Q11。

Q3:点击颜文字后没有反应。
> A:再按两次快捷键试试，请确保在你呼出选择窗口时，光标在一闪一闪等着你输入，而且在选择过程中没有切换到其他窗口。这个问题确实存在，但正常操作不易出现，如果你一直碰到这个问题，请参考Q11。

Q4:快捷键Ctrl和E直接太远了，我手短够不着，能换其他快捷键么？
> A:参考<高级用法-编辑配置文件-2.加速键>一节，快捷键的写法就按你的直觉写就好，大概是都能识别的。比如“ctrl+alt+enter”、“CTRL+ALT+SHIFT+W”、“Ctrl+Shift+3”等等。

Q5:编辑词库那个界面太难用了。
> A:我尽力了……你还有两个选择，一个是手工编写词库导出文件，一个是手工编辑程序的配置文件。参考<高级用法-编辑导出的词库文件>和<编辑配置文件-9.词库>。

Q6:界面好丑啊！
> A:我尽力了……

Q7:弹出的选择框能和输入法那样，在光标后面弹出来么？
> A:这个问题困扰我很久了，目前还解决不了，毕竟不是真正的输入法。

Q8:能改字体么？
> A:可以。默认字体是微软雅黑，如果你的电脑里没有这个字体，那你看到的可能是宋体。参考<高级用法-编辑配置文件-3.弹出窗口>

Q9:我想把我的做好的词库分享给我的朋友！
> A:参考<高级用法-导出词库>

Q10:默认的词库我不喜欢，我又懒得编辑。
> A:导入你朋友词库文件。

Q11:我发现了bug！
> A:请提交到[这里](https://github.com/wisaly/WinEmoticons/issues)。

Q12:我有个建议！
> A:参考Q11。

Q13:破程序又崩了！
> A:参考Q11...

Q14:我遇到了问题，我直接帮你改代码吧！
> A:推送修改吧，么么哒。[项目地址](https://github.com/wisaly/WinEmoticons)。

<!--
Q15:这个手册里面有好多奇怪的符号啊！
> A:这是MarkDown格式的。
-->

结束
----

Kris 写于2013-07-04。

我的联系方式：
>    邮箱 : wisaly@gmail.com
<br> 姬家 : gplus.to/mqm

~结束~